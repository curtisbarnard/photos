---
import { Image } from 'astro:assets';
interface Photo {
  src: string;
  alt: string;
  date: number;
}

const { photos = [] }: { photos?: Photo[] } = Astro.props;
---

<div class='gallery'>
  {
    photos.map((photo) => (
      <div class='photo-container'>
        <Image
          class='astro-photo'
          src={photo.src}
          format='webp'
          widths={[500, 1000]}
          sizes='(max-width: 500px) 500px, 1000px'
          alt={photo.alt}
          loading='lazy'
        />
        <p class='photo-overlay'>{photo.alt}</p>
      </div>
    ))
  }
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // For fading the photos on click
    const photoContainers = document.querySelectorAll('.photo-container');

    photoContainers.forEach((container) => {
      const img = container.querySelector('.astro-photo');
      const overlay = container.querySelector('.photo-overlay');

      container.addEventListener('click', () => {
        if (img) {
          const isFaded = img.classList.toggle('faded');
          if (overlay) {
            (overlay as HTMLElement).style.display = isFaded ? 'flex' : 'none';
          }
        }
      });
    });
  });
</script>

<style>
  .gallery {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1rem;
  }

  .photo-container {
    position: relative;
    display: inline-block;
  }

  .astro-photo {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .faded {
    opacity: 0.1;
  }

  .photo-overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    margin: 0;
    color: rgb(0, 0, 0);
    display: none;
  }
</style>
